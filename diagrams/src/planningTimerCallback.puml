@startuml 
start
if (Есть OctoMap и активная цель?) then (да)
        if (Цель не просрочена?) then (да)
            :Получить текущую позу дрона;
            if (Позу получить удалось?) then (да)
                 :Обновить высоту планирования\nв ValidityChecker;
                 :Вызвать **planPath()**;
                 if (Планирование успешно?) then (да)
                     :Опубликовать путь (planned_path_pub_);
                     :Опубликовать визуализацию (путь + цель);
                 else (нет)
                     :Опубликовать пустой путь;
                     :Опубликовать визуализацию (только цель);
                 endif
            else (нет)
                 :Пропустить цикл;
            endif
        else (нет, цель просрочена)
             :Деактивировать цель;
             :Опубликовать пустой путь;
             :Очистить визуализацию;
        endif

else (нет)
    :Очистить визуализацию;
    :Ждать карту и цель;
endif
stop

@enduml